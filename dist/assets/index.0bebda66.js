import{n as A,u as ne,_ as se}from"./index.a2bf8911.js";/* empty css                *//* empty css                *//* empty css               *//* empty css              *//* empty css              *//* empty css                *//* empty css               *//* empty css                *//* empty css                *//* empty css                *//* empty css                *//* empty css               *//* empty css                *//* empty css                *//* empty css               *//* empty css               *//* empty css               *//* empty css               */import{c as ue,d as le,r as re,e as g,o as ie,w as ce,aL as x,C as F,D as C,aI as e,u as f,aH as o,aN as c,aO as M,aF as E,aS as r,aY as pe,c9 as de,bb as me,b_ as _e,aW as fe,bM as ge,c4 as he,ba as ve,b$ as be,c6 as we,bP as xe,bO as Fe}from"./arco.b02d9b55.js";import{u as Ce}from"./loading.7f7bf96d.js";import{c as B}from"./cloneDeep.bb231cd9.js";import{a as ye}from"./index.c4821ce7.js";import Ee from"./index.5f1d25c0.js";import{I as N}from"./Icon.031e5930.js";import{h as Ae}from"./vue.e4c26cfd.js";import"./chart.67655b2c.js";import"./AddForm.5f13537c.js";/* empty css               *//* empty css               */import"./project.2f54d37c.js";import"./IconPicker.7129cb1a.js";function De(p){return A.get({url:"/project/upfile/get_list",params:p},{errorMessageMode:"none"})}function Se(p){return A.delete({url:"/project/upfile/del",params:p},{errorMessageMode:"message"})}const ke={}.VITE_APP_ENV=="production"?window==null?void 0:window.globalConfig.Upinfile_url:window==null?void 0:window.globalConfig.Upinfile_url_dev;function Ie(p,h){return A.uploadFile({url:`${ke}/project/upfile/uploadExcel`,onUploadProgress:h},p)}const Me=ue(()=>[{title:"\u7F16\u53F7",dataIndex:"id",slotName:"id",width:60,align:"center"},{title:"\u4E0A\u4F20\u65F6\u95F4",dataIndex:"create_time",slotName:"create_time",width:90,align:"center"},{title:"\u53D1\u6587\u6570",dataIndex:"project_count",slotName:"project_count",width:40,align:"center"},{title:"\u6587\u4EF6\u540D\u79F0",dataIndex:"file_name",slotName:"file_name",width:150,align:"center"},{title:"\u5BA1\u6279\u72B6\u6001",dataIndex:"approve_status",slotName:"approve_status",width:60,align:"center"},{title:"\u5BA1\u6279\u4FE1\u606F",dataIndex:"approve_note",slotName:"approve_note",width:100,align:"center"},{title:"\u64CD\u4F5C",dataIndex:"operations",slotName:"operations",width:80,fixed:"right",align:"center"}]),Be={class:"container"},Ne={key:0,style:{color:"gray"}},Pe={key:1,style:{color:"orangered"}},Ve={key:2,style:{color:"black"}},ze={name:"xx"},Oe=le({...ze,setup(p){const h=Ae();ne();const[P,{openModal:V}]=ye(),z=t=>{const s=new AbortController;return async function(){const{onProgress:b,onError:m,onSuccess:I,fileItem:_}=t;b(20);const w=n=>{let u;n.total>0&&(u=n.loaded/n.total*100),b(parseInt(String(u),10),n)};try{const n=(_==null?void 0:_.name)||"",u=await Ie({name:"file",file:_.file,filename:n},w);u?u.code==0?u.message=="\u6587\u4EF6\u5DF2\u4E0A\u4F20"?r.warning({content:"\u6587\u4EF6\u5DF2\u4E0A\u4F20",id:"upStatus",duration:3e3}):r.success({content:"\u4E0A\u4F20\u6210\u529F",id:"upStatus",duration:2e3}):r.error({content:u.message,id:"upStatus",duration:5e3}):r.error({content:u.message,id:"upStatus",duration:2e3}),l()}catch(n){m(n),r.error({content:"\u4E0A\u4F20\u5931\u8D25",id:"upStatus",duration:2e3})}}(),{abort(){s.abort()}}},i=re({...{current:1,pageSize:10},showTotal:!0,showPageSize:!0});document.documentElement.clientHeight;const{loading:O,setLoading:D}=Ce(!0),S=g([]),v=g([]),T=g([]);g("large");const k=()=>({createTime:"",approve_note:"",file_name:"",approve_status:"*"}),d=g(k()),l=async()=>{D(!0);try{const t=await De({page:i.current,pageSize:i.pageSize,...d.value});S.value=t.items,i.current=t.page,i.total=t.total}catch{}finally{D(!1)}};ie(()=>{});const U=()=>{l()},$=()=>{d.value=k(),l()},j=window==null?void 0:window.globalConfig.Main_url,L=()=>{let t=document.createElement("a");t.href=`${j}resource/staticfile/template.xlsx`,t.click()};l(),ce(()=>Me.value,t=>{v.value=B(t),v.value.forEach((s,y)=>{s.checked=!0}),T.value=B(v.value)},{deep:!0,immediate:!0});const R=async t=>{V(!0,{isUpdate:!1,record:t})},q=async()=>{l()},H=t=>{i.current=t,l()},W=t=>{i.pageSize=t,l()},G=async t=>{try{r.loading({content:"\u5220\u9664\u4E2D",id:"upStatus"}),await Se({ids:[t.id]})&&(l(),r.success({content:"\u5220\u9664\u6210\u529F",id:"upStatus"}))}catch{r.clear("top")}},Y=[{label:"\u5168\u90E8",value:"*"},{label:"\u901A\u8FC7",value:"1"},{label:"\u672A\u901A\u8FC7",value:"-1"},{label:"\u672A\u5BA1\u6279",value:"0"}];return(t,s)=>{const y=x("Breadcrumb"),b=x("icon-upload"),m=pe,I=de,_=x("icon-download"),w=me,n=_e,u=fe,J=ge,K=x("icon-search"),Q=he,X=ve,Z=be,ee=we,te=xe,oe=Fe;return F(),C("div",Be,[e(y,{items:[f(h).matched[0].meta.locale,f(h).meta.locale]},null,8,["items"]),e(oe,{class:"general-card onelineCard",style:{height:"calc(100% - 50px)"}},{default:o(()=>[e(Q,{style:{"margin-bottom":"10px"}},{default:o(()=>[e(n,{span:8},{default:o(()=>[e(w,null,{default:o(()=>[e(I,{"show-file-list":!1,multiple:!0,"custom-request":z},{"upload-button":o(()=>[e(m,{type:"primary"},{icon:o(()=>[e(b)]),default:o(()=>[c("\u6279\u91CF\u4E0A\u4F20 ")]),_:1})]),_:1}),e(m,{onClick:L},{icon:o(()=>[e(_)]),default:o(()=>[c(" \u6A21\u7248\u4E0B\u8F7D ")]),_:1})]),_:1})]),_:1}),e(n,{span:16,style:{"text-align":"right"}},{default:o(()=>[e(w,null,{default:o(()=>[e(u,{style:{width:"340px"},modelValue:d.value.file_name,"onUpdate:modelValue":s[0]||(s[0]=a=>d.value.file_name=a),placeholder:"\u6587\u4EF6\u540D\u79F0","allow-clear":""},{prefix:o(()=>[c(" \u6587\u4EF6\u540D: ")]),_:1},8,["modelValue"]),e(J,{options:Y,modelValue:d.value.approve_status,"onUpdate:modelValue":s[1]||(s[1]=a=>d.value.approve_status=a),style:{width:"200px"}},{prefix:o(()=>[c(" \u5BA1\u6279\u72B6\u6001: ")]),_:1},8,["modelValue"]),e(m,{type:"primary",onClick:U},{icon:o(()=>[e(K)]),default:o(()=>[c(" \u67E5\u8BE2 ")]),_:1}),e(m,{onClick:$},{default:o(()=>[c(M(t.$t("searchTable.form.reset")),1)]),_:1})]),_:1})]),_:1})]),_:1}),e(te,{"row-key":"id",loading:f(O),pagination:i,columns:v.value,data:S.value,bordered:{wrapper:!0,cell:!0},size:"large",scroll:{x:800},"default-expand-all-rows":!0,ref:"artable",onPageChange:H,onPageSizeChange:W},{file_name:o(({record:a})=>[e(X,{href:a.url,status:"success",target:"_blank"},{default:o(()=>[c(M(a.file_name),1)]),_:2},1032,["href"])]),approve_status:o(({record:a})=>[a.approve_status==0?(F(),C("span",Ne,"\u672A\u5BA1\u6279")):E("",!0),a.approve_status==1?(F(),C("span",Pe,"\u901A\u8FC7")):E("",!0),a.approve_status==-1?(F(),C("span",Ve,"\u4E0D\u901A\u8FC7")):E("",!0)]),operations:o(({record:a})=>[e(f(N),{icon:"svgfont-chakan",class:"iconbtn",onClick:ae=>R(a),size:18,color:"#0960bd"},null,8,["onClick"]),e(Z,{direction:"vertical"}),e(ee,{content:"\u60A8\u786E\u5B9A\u8981\u5220\u9664\u5417?",onOk:ae=>G(a)},{default:o(()=>[e(f(N),{icon:"svgfont-icon7",class:"iconbtn",size:18,color:"#ed6f6f"})]),_:2},1032,["onOk"])]),_:1},8,["loading","pagination","columns","data"])]),_:1}),e(Ee,{onRegister:f(P),onSuccess:q},null,8,["onRegister"])])}}});const ht=se(Oe,[["__scopeId","data-v-6bafb6d1"]]);export{ht as default};
