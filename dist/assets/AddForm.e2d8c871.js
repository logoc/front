import{n as h,p as C,_ as L}from"./index.a2bf8911.js";/* empty css               *//* empty css               *//* empty css                */import{d as O,e as n,c as V,u as E,aS as l,aL as I,C as T,aE as W,aH as u,G as _,F as k,aI as r,bU as j,aW as z,b7 as N,b_ as q,c4 as G,bW as Y,bc as J}from"./arco.b02d9b55.js";import{B as K,a as Q,u as X}from"./index.c4821ce7.js";import{u as Z}from"./loading.7f7bf96d.js";import{u as x}from"./common.66f89a6d.js";import ee from"./FileManage.59225568.js";function ye(e){return h.get({url:"/makecode/cate/get_list",params:e},{errorMessageMode:"none"})}function oe(e){return h.post({url:"/makecode/cate/save",params:e},{errorMessageMode:"message"})}function Ee(e){return h.post({url:"/makecode/cate/upStatus",params:e},{errorMessageMode:"message"})}function He(e){return h.delete({url:"/makecode/cate/del",params:e},{errorMessageMode:"message"})}const te=O({name:"AddBook",components:{BasicModal:K,FileManage:ee},emits:["success"],setup(e,{emit:d}){const[H,{openModal:D}]=Q(),w=n(!1),m=n(!1),F=n(420),p=n(420),i=n(),g={id:0,name:""},t=n(g),b=n(),[M,{setModalProps:v,closeModal:S}]=X(async o=>{var a;(a=i.value)==null||a.resetFields(),v({confirmLoading:!1}),m.value=!!(o!=null&&o.isUpdate),E(m)?t.value=C(o.record):t.value=g}),R=V(()=>E(m)?"\u7F16\u8F91\u6570\u636E":"\u65B0\u589E\u6570\u636E"),{loading:U,setLoading:y}=Z();return{registerModal:M,getTitle:R,handleSubmit:async()=>{var o;try{if(!await((o=i.value)==null?void 0:o.validate())){y(!0),l.loading({content:"\u63D0\u4EA4\u4E2D",id:"upStatus",duration:0});let A=C(E(t));await oe(A),l.success({content:"\u63D0\u4EA4\u6210\u529F",id:"upStatus",duration:1500}),S(),d("success"),y(!1)}}catch{y(!1),l.clear("top")}},formRef:i,loading:U,formData:t,OYoptions:[{label:"\u5426",value:0},{label:"\u662F",value:1}],SHoptions:[{label:"\u6B63\u5E38",value:0},{label:"\u7981\u7528",value:1}],customupFile:o=>{l.loading({content:"\u4E0A\u4F20\u4E2D",id:"upStatus",duration:0});const a=new AbortController;return async function(){const{onProgress:B,onError:$,onSuccess:pe,fileItem:f}=o;B(20);const P=s=>{let c;s.total>0&&(c=s.loaded/s.total*100),B(parseInt(String(c),10),s)};try{const s=(f==null?void 0:f.name)||"",c=await x({name:"file",file:f.file,filename:s,data:{cid:0}},P);c&&(t.value.replaceFile=c.url),l.success({content:"\u4E0A\u4F20\u6210\u529F",id:"upStatus",duration:2e3})}catch(s){$(s),l.error({content:"\u4E0A\u4F20\u5931\u8D25",id:"upStatus",duration:2e3})}}(),{abort(){a.abort()}}},modelHeight:F,editorRef:b,onHeightChange:o=>{p.value=o},windHeight:p,registerFileModal:H,selectImg:o=>{o.type=="more"?o.list.forEach(a=>{console.log("\u591A\u5F20\u9644\u4EF6\u8FD4\u56DE:",a)}):o.type=="one"&&(t.value.replaceimage=o.url)},UpImage:()=>{D(!0,{filetype:"image",getnumber:"one",openfrom:"use"})},visibleimage:w}}});const ae={class:"tabs-content"},se={class:"content_box"},ne={class:"besecontent"};function re(e,d,H,D,w,m){const F=z,p=N,i=q,g=G,t=Y,b=J,M=I("FileManage"),v=I("BasicModal");return T(),W(v,j(e.$attrs,{onRegister:e.registerModal,isPadding:!1,loading:e.loading,width:"800px",onHeightChange:e.onHeightChange,minHeight:e.modelHeight,title:e.getTitle,onOk:e.handleSubmit}),{default:u(()=>[_("div",{class:"addFormbox",style:k({"min-height":`${e.windHeight}px`})},[_("div",ae,[r(b,{ref:"formRef",model:e.formData,"auto-label-width":""},{default:u(()=>[_("div",se,[r(t,{style:k([{overflow:"auto"},{height:`${e.windHeight}px`}])},{default:u(()=>[_("div",ne,[r(g,{gutter:16},{default:u(()=>[r(i,{span:12},{default:u(()=>[r(p,{field:"name",label:"\u540D\u79F0"},{default:u(()=>[r(F,{modelValue:e.formData.name,"onUpdate:modelValue":d[0]||(d[0]=S=>e.formData.name=S),placeholder:"\u8BF7\u586B\u540D\u79F0"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})])]),_:1},8,["style"])])]),_:1},8,["model"])])],4),r(M,{onRegister:e.registerFileModal,onSuccess:e.selectImg},null,8,["onRegister","onSuccess"])]),_:1},16,["onRegister","loading","onHeightChange","minHeight","title","onOk"])}const le=L(te,[["render",re],["__scopeId","data-v-10859c86"]]),De=Object.freeze(Object.defineProperty({__proto__:null,default:le},Symbol.toStringTag,{value:"Module"}));export{le as A,De as a,He as d,ye as g,Ee as u};
